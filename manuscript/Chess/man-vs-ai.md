## 3.8 Человек против шахматной программы

Последний крупный матч человека против шахматной программы состоялся в ноябре 2006 года. Действующий на тот момент чемпион мира Владимир Крамник играл против движка Deep Fritz. Матч закончился победой Deep Fritz со счётом 4-2: четыре ничьи и две победы программы. Шахматист не смог выиграть ни одной партии.

Во время матча Deep Fritz работал на мощном по меркам того времени персональном компьютере. Но его вычислительные ресурсы значительно уступали шахматному суперкомпьютеру Deep Blue. Скорость работы программы и суперкомпьютера отличалась на два порядка:

* Deep Fritz просчитывал около 8 миллионов позиций в секунду.

* Deep Blue — от 100 до 300 миллионов в зависимости от конфигурации.

Несмотря на скромную производительность, Deep Fritz одержал уверенную победу над чемпионом мира. Этот матч показал, насколько выросло качество шахматных программ спустя 10 лет после противостояния Гарри Каспарова и Deep Blue.

В условиях матча современные шахматные движки не оставляют шансов лучшим игрокам. Ведущие шахматисты единогласно признают, что человек уже давно не может конкурировать с машиной. Этот вопрос считается решённым однозначно и окончательно.

Можно ли сказать что-то новое о противостоянии человека и шахматной программы? Что если посмотреть на него под несколько непривычным углом?

### 3.8.1 Ошибки в программах

Матчи гроссмейстеров с шахматными программами комментируют профессионалы. Они — эксперты в предметной области и знают тонкости шахматной игры. Опираясь на свой опыт, комментатор рассказывает о позициях, ходах, вариантах, комбинациях и ошибках. Точка зрения именно этих экспертов звучит в репортажах со всех шахматных событий. Но когда речь заходит о программах, эта точка зрения не единственно возможная.

Шахматные движки разрабатывают профессиональные программисты. Это другой вид экспертов, который имеет отношение к компьютерным шахматам. К сожалению, эти эксперты редко высказываются о поединке человека и машины. Одну из самых известных попыток предпринял Фэн Сюн Сю. Он опубликовал книгу "Behind Deep Blue" о поединке суперкомпьютера IBM и Гарри Каспарова.

Что может рассказать разработчик шахматной программы? В своей книге Фэн Сюн Сю знакомит читателя с техническими задачами и проблемами, которые решала его команда. Комментируя партии, он часто говорит о программных и аппаратных ошибках. Именно из-за них Deep Blue делал слабые ходы, терял позиционное преимущество и проигрывал. Означает ли это, что ключ к победе над шахматной программой кроется в ошибках её реализации? Если да, то изменилось ли что-то со времён Deep Blue?

Управляющая программа для Deep Blue была разработана почти 30 лет назад. Методология программирования продвинулась далеко вперёд за это время. Но проблема ошибок никуда не делась. Современные программы аварийно завершаются, теряют данные пользователей и зависают точно так же, как и 30 лет назад. Так происходит потому, что разработка программного обеспечения — это компромисс между функциональностью, стоимостью, временем и качеством. Чем-то всегда приходится жертвовать. Разработка шахматной программы в этом плане ничем не отличается.

Чтобы найти и исправить ошибки в программах, разработчики используют разные методы тестирования. Например, это может быть ручная проверка самых важный функций программы. Какие-то шаги тестирования можно автоматизировать. Специальные системы могут запускать программу и выполнять в ней стандартные действия. Тем самым они проверяют, что она по-прежнему работает.

В истории шахматных программ можно заметить некоторую закономерность. Метод поиска ошибок в них постоянно развивался. Одновременно с этим рос их уровень игры. Значительные скачки в силе программ происходили именно тогда, когда разработчики применяли новый метод тестирования. Есть ли какая-то взаимосвязь между этими событиями? Попробуем разобраться.

Рассмотрим три показательных эпизода из истории компьютерных шахмат. Мы сфокусируемся на том, как разработчики шахматных программ искали в них ошибки.

#### 3.8.1.1 Ручной несистематический поиск

В 1960-х годах методология разработки и тестирования ПО только зарождалась. Автор программы сам тестировал её вручную. Обычно он пробовал разные входные данные и проверял, что вывод программы соответствует ожидаемому.

Разработчики первых шахматных программ следовали общепринятой практике. Они применяли простую стратегию тестирования, которая состояла из трёх стадий.

На **первой стадии** автор играет со своей программой несколько партий. Он проверяет, что в ней нет очевидных критических проблем. Вот несколько примеров:

* Программа во время партии аварийно завершается (**сбой** или crash).

* Программа нарушает правила игры.

* Программа зависает.

* Программа жертвует фигуры просто так или делает бессмысленные ходы.

Если одна из подобных проблем происходит, разработчик пытается понять и устранить её причину. После этого он повторяет первую стадию тестирования.

Когда программа начинает работать стабильно без критических ошибок, наступает **вторая стадия** тестирования. Разработчик обращается к одному или нескольким сильным шахматистам. Они проводят серию игр против программы и указывают на её слабости. Типичная их причина — неверные представления разработчика о шахматной игре. Его плохое владение предметной областью выливается в логические ошибки программы.

I> [**Логической ошибкой**](https://ru.wikipedia.org/wiki/Логическая_ошибка_(программирование)) называется неправильное действие программы на этапе принятия решений.

Получив обратную связь от экспертов в предметной области, разработчик шахматной программы исправляет её поведение.

На **третьей стадии** тестирования шахматная программа играет на турнирах. Это партии с классическим контролем времени против шахматистов и других программ. На этой стадии разработчик наблюдает, как программа работает в максимально сложных для неё условиях. Если происходит сбой или слабый ход, автор собирает всю доступную информацию об этом событии. Таким образом, он ищет причину ошибки и исправляет код, который её вызвал.

Мы рассмотрели стратегию поиска ошибок в шахматных программах, состоящую из трёх стадий. Назовём её **ручным несистематическим поиском**. Слово **ручной** означает, что все шаги выполняет человек без какой-либо автоматизации. Так или иначе он играет полные партии против программы.

Поиск называется **несистематическим**, потому что в нём нет строго плана. На каждой стадии тестирования человек играет против программы. Тем самым он проверяет её основные функции. В одной из партий может проявиться какая-то ошибка. Но это будет чистой случайностью. Ходы и позиции могут сложиться так, что проблемы не проявятся ни в одной партии. В этом случае разработчик программы о них не узнает и не устранит.

Эффективность ручного несистематического поиска ошибок зависит только от интенсивности тестирования. Чем больше партий сыграет шахматная программа, тем выше шанс воспроизвести какую-то из её ошибок. Только тогда у разработчика появится шанс исправить проблему. Ошибки, которые ни разу не воспроизвелись, останутся скрытыми. Их невозможно исправить из-за отсутствия информации.

I> **Скрытой ошибкой** (latent defect) программы называется проблема, которая не была обнаружена на этапе тестирования. Она проявляется только после того, как ПО было выпущено и использовалось в определённых условиях.

#### 3.8.1.2 Ручной систематический поиск

Стратегия ручного несистематического поиска ошибок имеет предел. Если таким способом интенсивно тестировать шахматную программу, рано или поздно уровень её игры перестанет расти. Это происходит по нескольким причинам.

Во-первых, в программе остаётся мало скрытых ошибок. Чтобы их воспроизвести нужны очень специфичные позиции и условия. Эти позиции могут никогда не сложиться в тестовых партиях со стандартными дебютами и эндшпилями. 

Во-вторых, ручной несистематический поиск малоэффективен. Воспроизведение какой-то конкретной проблемы занимает много времени, потому что тестировщик вынужден играть каждую шахматную партию с самого начала. Если ошибка воспроизводится в сложном миттельшпиле, чтобы её воспроизвести надо отыграть дебют.

В-третьих, некоторые ошибки программы могут быть очень тонкими. Только профессиональный шахматист высочайшего уровня способен понять такую ошибку и объяснить её суть разработчику программы. Но у чемпиона мира и претендентов на его место нет времени интенсивно тестировать шахматный движок. Играя против программы матч, профессионал найдёт эту ошибку и воспользуется ей. Заранее же разработчик про неё не узнает.

Именно с этими трудностями столкнулась команда Deep Blue в первом матче против Гарри Каспарова в 1996 году. Вероятно, уровень игры компьютера на тот момент был близок к тому максимуму, который давал ручной несистематический поиск ошибок. До уровня Гарри Каспарова он не дотягивал.

Одной из главных проблем был слишком долгий цикл обработки ошибок:
{line-numbers: false, format: text}
```
обнаружение -> исследование причин -> исправление -> тестирование
```

Чтобы его ускорить, команда Deep Blue создала специальные инструменты для тестирования и отладки. Одним из них был программный прототип функции оценки Deep Blue с графическим интерфейсом. Его возможности напоминали современный шахматный движок и интерфейс к нему.

Рассмотрим, как работал инструмент тестирования Deep Blue. Через графический интерфейс пользователь задавал произвольную позицию фигур на доске или загружал её из файла. После этого функция оценки проверяла заданную позицию. Для каждого возможного хода она давала некоторый балл. Графический интерфейс выводил эти баллы в наглядной форме. Также пользователь видел диагностическую информацию о том, какие факторы позиции повлияли на оценку.

Новый инструмент тестирования стал отправной точкой для новой стратегии поиска ошибок. Раньше штатный гроссмейстер проекта проверял игру Deep Blue в полноценных партиях. Теперь достаточно было ввести нужную позицию и получить лучший ход по мнению компьютера. Такой подход намного повысил эффективность тестирования. Время на обработку каждой отдельной ошибки значительно сократилось.

Вторым компонентом новой стратегии поиска ошибок стало дополнительное правило в играх с компьютером. Чтобы тестовые партии стали эффективнее, разработчики разрешили штатному шахматисту брать ход назад в любой позиции. Это позволило игроку возвращаться назад и исправлять свои ошибки. Таким образом он мог играть на равных с Deep Blue, который превосходил его минимум на 200 пунктов Эло. При равной игре ошибки компьютера стали воспроизводиться чаще и очевиднее. Он перестал выигрывать из-за банальных зевков оппонента.

Назовём стратегию поиска ошибок команды Deep Blue **ручным систематическим поиском**. Поиск **ручной**, потому что его по-прежнему выполняет человек без автоматизации. Но на этот раз тестировщик пользуется специальными инструментами и расширенными правилами игры.

Поиск называется **систематическим**, потому что у него есть строгий план действий. Этот план выглядит следующим образом:

1. Получить предварительную информацию о предполагаемой ошибке. Например, тестировщик знает, что в программе изменилась оценка пешечной структуры. Тогда он должен сконцентрироваться на позициях с различной конфигурацией пешек и проверить, что программа правильно в них ориентируется.

2. Создать полностью повторяемую среду для воспроизведения ошибки. Это означает, что ни аппаратное обеспечение, ни программна не должны меняться между тестами. Тестировщик всегда берёт один и тот же компьютер и запускает на нём одну и ту же версию программы или инструмента тестирования.

3. Следовать повторяемым путём для воспроизведения ошибки. Это означает, что тестировщик на каждой итерации выполняет одни и те же действия, которые приводят к одним и тем же результатам. 

4. Если ошибка воспроизвелась, зафиксировать состояние программы и среды её выполнения (например, состояние аппаратуры). Именно один из параметров этого состояния провоцирует возникшую ошибку. Задача разработчика — понять, какой именно параметр.

Рассмотрим, как команда Deep Blue следовала этому плану тестирования. Первый пункт — узнать о предполагаемой ошибке компьютера. Было несколько способов это сделать:

1. Получить информацию от разработчика, который изменил что-то в управляющей программе или прошивке шахматного чипа. Это изменение потенциально могло привести к ошибкам в позициях, когда оно влияет на выбор хода.

2. Во время тестовой игры с правилом брать ход назад, Deep Blue делает слабый ход. Это сигнал о том, что в программе Deep Blue есть ошибка.

3. Во время очередной турнирной партии Deep Blue делает слабый ход. Лог файл игры позволял точно восстановить ход этой партии.

Второй пункт плана — создать полностью повторяемую среду для воспроизведения ошибки. Разработчики Deep Blue могли его выполнить. Они контролировали версии управляющей программы, шахматных чипов и их прошивки. Это позволяло воссоздать комбинацию аппаратного обеспечения и программ, в которой произошла ошибка.

Третий пункт — следовать повторяемым путём для воспроизведения ошибки. Это условие практически невозможно выполнить, если играть обычные партии против шахматной программы. Дело в том, что на алгоритм её работы влияет много случайностей. Эту проблему решил специальный инструмент тестирования команды Deep Blue. Благодаря ему, можно было не играть партию целиком, а сразу выставить нужную позицию фигур.

Четвёртый пункт плана — зафиксировать состояние программы и оборудования. У команды Deep Blue были инструменты для анализа управляющей программы и прошивки шахматных процессоров. Так они собирали полную информацию о среде выполнения в состоянии ошибки. Это помогало выяснить причину ошибки и исправить её.

На исход второго матча Гарри Каспарова против Deep Blue 1997 года повлияло много факторов. Одним из них стала новая стратегия поиска ошибок команды Deep Blue. Благодаря ей, разработчики могли оперативно вносить изменения в управляющую программу компьютера. Если Гарри Каспаров находил какой-то изъян в игре оппонента, команда Deep Blue успевала исправить его до следующей партии. Это уравнивало шансы сторон: человек и машина адаптировались к игре друг друга по ходу матча.

#### 3.8.1.3 Автоматический систематический поиск

Если программа запускается на специализированном шахматном компьютере, это ограничивает возможности её тестирования. Проблема в том, что шахматный компьютер — это уникальное оборудование в единственном экземпляре. Поэтому невозможно устроить партию между разными версиями этого компьютера или его управляющей программы.

В конце 1990-х годов платформой для шахматных программ стали обычные ПК. Они работают под управлением многозадачной операционной системы (ОС). Такая ОС позволяет выполнять несколько программ одновременно. На одном ПК можно запустить два разных шахматных движка и устроить между ними партию.

Возможности платформы ПК позволили применить новые методы тестирования. Разработчики начали регулярно сравнивать игру разных версий своих шахматных движков. Скоро они пришли к идее автоматизировать этот процесс. Появились системы для управления тестированием. Такая система запускает указанные версии движка и проводит между ними серию партий. Она же ведёт статистику побед и записывает ходы в каждой партии. В конце работы система выдаёт отчёт с результатами.

Появилась новая стратегия поиска ошибок. В ней большую часть работы выполняет специализированная система. Назовём такую стратегию **автоматическим систематическим поиском**. Поиск **автоматический**, потому что частично его выполняет система тестирования без участия человека.

Поиск называется **систематическим**, потому что выполняется по строгому плану. План заключается в последовательном запуске ряда автоматических тестов. Каждый из них фокусируется на ошибках разного типа.

Разработчики каждого современного шахматного движка пользуются системой автоматического тестирования. Она выполняет тесты следующих типов:

1. **Автоматическое регрессионное тестирование** проверяет новую версию движка на заранее подготовленном наборе типовых позиций. Такой тест показывает, что ранее исправленные ошибки не вернулись.

2. **Интеграционное тестирование** запускается каждый раз, когда в кодовую базу программы вносится какое-то изменение. Тест проверяет, что не появилось новых ошибок.

3. **Тест производительности** проверяет, что движок не стал работать медленнее из-за последних изменений. Новая версия программы обрабатывает набор специально подготовленных сложных позиций. Для каждой позиции система тестирования оценивает:

   * Глубину поиска, достигнутую в единицу времени.
   * Количество узлов дерева игры, проверяемых в секунду.

4. **Автоматические турниры** проводятся между разными версиями движка. Турнир даёт статистику, которой достаточно для сравнения относительного уровня Эло этих версий.

5. **Тестирование дебютов и эндшпилей** проверяет, что движок по-прежнему корректно работает на этих стадиях партии.

Такой план тестирования обнаруживает ошибки на ранней стадии. Часто интеграционный тест может точно указать на изменение, которое вызвало ошибку. Это значительно сокращает цикл исправления ошибок и повышает эффективность разработки. Программисты могут смелее экспериментировать с небольшими изменениями и последовательно улучшать разные части движка.

Автоматическое тестирование легко масштабировать. Для этого достаточно подключить больше компьютеров к системе. Тогда все пять типов тестов станут интенсивнее. Команда проекта Stockfish вывела масштаб автоматизированных тестов на беспрецедентный уровень. Система Fishtest объединяет сотни компьютеров добровольцев в единую сеть. Эта сеть выполняет интенсивные автоматические тесты на разнообразном оборудование.

Оценим примерный выигрыш производительности, который дала система Fishtest. Допустим, что две версии движка тестируются в партиях с укороченным контролем времени — 1 минута на игру. Пусть один экземпляр движка работает на одном ядре процессора. Современный процессор Intel имеет минимум 8 ядер. Тогда на одном современном ПК можно запустить примерно `60 * 24 * 8 / 2 = 5760` игр в день.

Компания по разработке коммерческого шахматного движка может выделить для запуска тестов от нескольких десятков до сотни компьютеров. Это позволит проигрывать около `100 * 5760 = 576000` партий в день.

К сети системы Fishtest ежедневно подключаются от сотни до тысячи компьютеров. Возьмём среднее число — 550 компьютеров. Тогда в день система сможет сыграть примерно `550 * 5760 = 3,168,000` партий. Это почти в четыре раза больше, чем позволяют ресурсы разработчиков коммерческого движка.

Качество автоматического тестирования напрямую зависит от его интенсивности. Система Fishtest предоставляет колоссальные вычислительные ресурсы. Именно благодаря им движок Stockfish сохраняет лидерство во всех турнирных таблицах.

### 3.8.2 Игра против шахматного движка

Мы познакомились с тремя стратегиями поиска ошибок, которые применяют разработчики шахматных программ. Какое отношение это имеет к игре человека против движка?

Клод Шеннон в статье "Программирование компьютера для игры в шахматы" указал четыре преимущества машины над человеком:

1. Высокая скорость вычислений.

2. Свобода от ошибок. Ошибки машины происходят из-за изъянов в управляющей программе. В то же время игроки любого уровня регулярно совершают грубые промахи.

3. Свобода от лени. Игрокам слишком легко делать инстинктивные ходы без надлежащего анализа позиции.

4. Свобода от "никогда". Игроки склонны к ошибкам из-за чрезмерной самоуверенности в "выигрышных" позициях. С другой стороны, в "проигрышных" позициях игроки преждевременно сдаются и не проверяют все возможности.

Таким образом Клод Шеннон утверждает, что изъяны в программе — это единственный источник слабой игры машины.

С момента публикации статьи шахматные программы совершенствовались десятилетиями. Вычислительная мощность и точность современных шахматных движков достигла высочайшего уровня. Они используют самые полные книги дебютов и таблиц эндшпилей. Программы никогда не устают и не испытывают никаких эмоций. Всё это делает современный движок практически идеальным игроком.

Теперь давайте поговорим о том, как профессионалы играют в шахматы. Представим партию между двумя гроссмейстерами с примерно равным уровнем Эло. Если обе стороны идеально исполняют свой план на игру, вероятнее всего, партия закончится ничьей. Но если одна из сторон допускает промах, оппонент получает преимущество. Речь идёт даже не о зевке пешки. Промахом может быть небольшое смещение фигур, которое лишь немного ухудшает позицию. Такое незначительное преимущество игрок высокого уровня способен превратить в победу.

Партия против современного шахматного движка — это противостояние идеальному игроку. Поэтому цена любого промаха в ней так же высока, как и в партии высокого уровня между двумя гроссмейстерами. Из этого следует два вывода:

1. Играя против современного шахматного движка, нельзя ошибаться. Любая ошибка приводит к поражению.

2. Единственная возможность выиграть — получить преимущество и развить его в победу, когда движок допустить ошибку.

Если придерживаться мнения Клода Шеннона, то недочёт в почти идеальной игре движка возникает только тогда, когда происходит логическая ошибка в его программе. Это означает, что слабые стороны шахматного движка создают те самые ошибки, которые ищут и устраняют его разработчики.

Мы подробно рассмотрели три стратегии поиска ошибок в шахматных программах. Возникает вопрос: может ли шахматист применить какую-то из них, чтобы найти слабые стороны движка? Очевидно, что может. Но перед тем как углубиться в эту тему, поговорим о типах ошибок в шахматных движках. Это объяснит, что именно следует искать шахматисту.

#### 3.8.2.1 Классификация ошибок шахматного движка

Можно придумать разные критерии для классификации ошибок шахматного движка. Самый очевидный критерий — это компонент программы, в работе которого есть ошибка.

Мы уже знакомы с пятью основными частями типичного шахматного движка: 

1. Генератор ходов
2. Функция оценки позиции
3. Алгоритм поиска
4. Дебютная книга
5. Таблицы эндшпилей.

Опираясь на этот список, можно предложить следующую классификацию ошибок:

1. **Ошибки генерации ходов**. Например, генератор упускает какие-то из возможных ходов или выдаёт ходы, запрещённые правилами игры.

2. **Ошибки функции оценки** или альтернативного механизма (сеть NNUE).

   * Ошибка в оценке материала. Например, движок неверно оценивает разность между слонами и конями в определённых позициях.

   * Ошибки в оценке позиции — это неверные суждения движка о нематериальных аспектах. Например, мобильность фигур, безопасность короля, контроль ключевых полей.

   * Переобучение (overfitting) — результат функции оценки или сети NNUE слишком сильно подогнан под специфичные позиции фигур. В этом случае возможна неверная оценка позиций, которые не попали в тестовый набор.

   * Недообучение (underfitting) — функция оценки или сеть NNUE слишком простая и не учитывает все аспекты позиции.

3. **Ошибки алгоритма поиска** — это ошибки в реализации самого алгоритма и вспомогательных эвристик выборочного поиска.

   * Эффект горизонта — движок не просматривает дерево игры дальше некоторой глубины. Это может привести к решениям, которые дают краткосрочную выгоду, но плохи в долгосрочной перспективе.

   * Ошибки поиска покоя — движок выполнил продление до позиции, которую ошибочно посчитал спокойной. На самом деле в позиции остаются варианты, которые кардинально меняют её оценку. 

   * Ошибки отсечений — движок отсекает части дерева, которые содержат важные ходы и позиции.

   * Ошибка управления временем — движок неправильно учитывает время, отведённое на ход. Например, он агрессивно отсекает ветви дерева игры, когда у него в запасе остаётся ещё много времени. В этом случае движок принимает поспешное решение и не использует эффективно свою глубину поиска.

4. **Ошибки в дебютной книге**. Например, в ней отсутствуют новинки, которые известны некоторым игрокам высшего уровня.

5. **Ошибки в таблице эндшпилей**.

   * Ошибки чтения и интерпретации импортированных таблиц для решённых эндшпилей.
   
   * Неполные знания по теории эндшпилей.

6. **Общие программные ошибки** — это проблемы, которые характерны для любой программы и не зависят от её предметной области.

   * Ошибки параллельного исполнения кода — связаны с запуском движка в нескольких потоках выполнения (thread). Такие ошибки приводят к потере данных и блокировке исполнения программы. 

   * Утечки памяти — это ситуация, когда программа запросила память у операционной системы, но не освободила её после использования. Если программа работает долгое время и утечки происходят постоянно, в системе возникает дефицит памяти. Он значительно снижает производительность движка.

I> [**Поток выполнения**](https://ru.wikipedia.org/wiki/Поток_выполнения) (thread) — это последовательность шагов программы, которая может выполняться независимо от остальных. Разделение программы на потоки позволяет быстрее выполнять её на многоядерных процессорах. В этом случае каждое ядро получает один поток и исполняет его независимо.

Ошибка любого типа может привести к слабости шахматного движка. Поэтому имеет смысл искать ошибки всех типов и рассматривать условия, в которых они могут проявляться.

#### 3.8.2.2 Сценарии игры против шахматного движка

Мы познакомились с типами ошибок и стратегиями их поиска. Теперь рассмотрим, как применить эти знания на практике, чтобы найти слабые стороны шахматного движка.

У каждого шахматиста высокого уровня есть команда, которая помогает ему в подготовке к матчам и турнирам. В эту команду обычно входят менеджер, тренер, другие шахматисты и психолог.

Для игры против шахматного движка нужны знания из разных прикладных областей. Маловероятно, что один человек овладеет этими знаниями на высоком уровне. Поэтому мы рассмотрим игру команды экспертов против шахматного движка. Такой подход кажется справедливым. Потому что шахматный движок — это не один оппонент. Как и за профессиональным шахматистом, за движком ним стоит большая команда: разработчики, тестировщики, менеджеры и шахматисты-консультанты проекта.

Состав команды экспертов, которая играет против движка, может быть разным. Этот состав определяет сценарий подготовки команды к матчу. Рассмотрим возможные сценарии и начнём с самого простого случая.

#### 3.8.2.3 Первый сценарий РНП

В первом сценарии команда экспертов работает в следующих условиях:

1. Команда состоит только из шахматистов.

2. У команды нет доступа к версии шахматного движка, с которой предстоит играть. Также нет никакой информации о слабых сторонах.

3. У команды нет специальных инструментов для подготовки к игре против движка. Речь идёт о программах, которые не входят в обычный набор шахматиста для подготовки к турнирам.

Именно в таких условиях проходит типичный матч шахматиста высокого уровня против движка. Его исход зависит от многих факторов и случайностей, как и в случае игры двух гроссмейстеров. Сейчас мы сконцентрируемся только на одной стороне противостояния — поиске ошибок.

Разработчики шахматного движка, с которым проходит игра, следуют одной из трёх стратегий поиска ошибок:

1. Ручной несистематический поиск (РНП).

2. Ручной систематический поиск (РСП).

3. Автоматический систематический поиск (АСП).

Команда экспертов может применить только ручной несистематический поиск ошибок. Другими словами, команда экспертов готовится точно так же, как к обычному матчу против игрока высокого уровня. Затем сильнейший шахматист команды играет серию партий против шахматного движка. Только во время этих игр он может экспериментировать и искать слабости программы. Разберёмся, почему команде недоступны более сильные стратегии.

Ручной систематический поиск ошибок предполагает строгий план из четырёх пунктов. Команда экспертов может выполнить только один из них — создать полностью повторяемую среду для воспроизведения ошибки. Для этого надо договориться с разработчиками движка о том, что ни аппаратное обеспечение, ни программа не будут меняться между партиями. Остальные три пункта плана выполнить невозможно:

1. Получить предварительную информацию о предполагаемой ошибке.

2. Следовать повторяемым путём для воспроизведения ошибки.

3. Если ошибка воспроизвелась, зафиксировать состояние программы и среды её выполнения

Для автоматического систематического поиска ошибок нужна специальная система тестирования. В нашем сценарии у команды нет эксперта по разработке программ, а следовательно нет и специальных инструментов. Поэтому эта стратегия поиска также невыполнима.

Возможны три комбинации стратегий, которым следуют разработчики шахматного движка и команда экспертов. Для краткости сократим названия стратегий поиска по первым буквам:

1. Разработчики движка — РНП, команда экспертов — РНП.

2. Разработчики движка — РСП, команда экспертов — РНП.

3. Разработчики движка — АСП, команда экспертов — РНП.

В первом случае (РНП-РНП) стороны следуют одинаковой стратегии поиска ошибок. Со стороны команды экспертов это выглядит следующим образом. Самый сильный шахматист играет партии против движка, опираясь на свои экспертные знания. В ходе игры он создаёт различные позиции, которые считает сложными для просчёта программой. Если в одной из них движок ошибается, у шахматиста появляется план на матч. Он заключается в эксплуатации найденной ошибки.

I> **Эксплуатация ошибок** — это преднамеренное выявление и использование ошибок или уязвимостей в программе. Цель использования ошибок — достижение результатов, непредусмотренных разработчиками.

История развития шахматных программ показывает, что в первой комбинации стратегий (РНП-РНП) у команды экспертов очень высокие шансы на победу. Победа практически гарантирована, если им удалось найти ошибку, а у разработчиков движка нет возможности её исправить. Эта ошибка будет воспроизводиться каждый раз при создании подходящих условий. Вопрос только в том, насколько их сложно создать. Примеры игр в таких условиях: матч Гарри Каспарова против Deep Thought 1989 года и его первый матч против Deep Blue 1996 года.

Вторая возможная комбинация стратегий — РСП-РНП. В этом случае стратегия разработчиков движка сильнее. До матча они уже обнаружили и исправили большинство ошибок, которые можно найти более слабой стратегией РНП. Кроме этого, в ходе самого матча стратегия РСП позволяет оперативно исправлять обнаруженные ошибки. Пример игры в таких условиях: матч Гарри Каспарова против Deep Blue 1997 года.

В матче 1997 года у Гарри Каспарова была чёткая стратегия: придерживаться закрытых позиций и не давать компьютеру возможности для сильной тактической игры. Этот подход хорошо работал против шахматных программ того времени. Он заставлял компьютер вести стратегическую игру, качество которой сильно зависит от точной оценки позиции. Малейшие изъяны функции оценки приводят к слабым ходам и потере темпа.

Стратегия Гарри Каспарова оказалась успешна: он действительно находил слабости компьютера. Проблема была в том, что у шахматиста не было возможности их эксплуатировать. Когда ошибка проявлялась в одной партии, команда Deep Blue успевала её исправить до следующей партии. Поэтому в каждой игре Гарри Каспаров начинал искать слабости компьютера с нуля. В таких условиях компьютер с огромной вычислительной мощностью одержал победу.

Третья возможная комбинация стратегий — АСП-РНП. Стратегия разработчиков движка намного сильнее. С очень большой вероятностью автоматические тесты уже обнаружили все ошибки, которые во время матча можно найти вручную. Поэтому разработчики устранили все эти проблемы заранее.

Допустим, что разработчики движка используют стратегию АСП. Это означает, что у них есть специализированные инструменты для отладки. Другими словами, у них все средства чтобы также выполнять стратегию РСП. Поэтому во время матча против команды экспертов разработчики могут оперативно исправлять ошибки движка между партиями. Такие широкие возможности делают победу команды экспертов маловероятной. Хороший пример игры в таких условиях: матч Владимира Крамника против движка Deep Fritz в 2006 году.

#### 3.8.2.4 Второй сценарий РСП

Второй сценарий игры команды экспертов против шахматного движка выглядит следующим образом:

1. Команда экспертов состоит из шахматистов, разработчика шахматных движков и специалиста по компьютерной безопасности.

2. В распоряжении команды есть точная версия шахматного движка, с которой предстоит играть. Также доступна история его изменений и исходный код.

3. У команды нет специальных инструментов для подготовки к матчу.

В таких условиях команда экспертов может применить стратегию ручного систематического поиска ошибок (РСП). Специалисты могут выполнить все шаги этой стратегии, имея на руках движок и его исходный код.

Рассмотрим пример. Допустим, что проводится матч между командой экспертов и движком Stockfish. Для определённости пусть это будет версия 14, выпущенная в 2021 году. Это версия достаточно старая и это важно.

Исход матча во многом зависит от подготовки команды экспертов. Она заключается в том, чтобы заранее найти ряд слабостей движка и научиться создавать условия для их воспроизведения. Затем во время матча шахматист команды должен эксплуатировать эти слабости, чтобы получить преимущество.

План подготовки команды экспертов может быть следующим:

1. Разработчик шахматных движков просматривает [историю изменений](https://github.com/official-stockfish/Stockfish/commits/master/) Stockfish. Он составляет список изменений, которые были сделаны после выпуска версии 14. Они исправляют какие-то ошибки и недочёты этой версии. Чем старее версия движка, тем длиннее этот список.

2. Разработчик шахматных движков оценивает каждое изменение в составленном списке. Он ищет исправления ошибок следующих типов:

   * Ошибки генерации ходов
   * Ошибки функции оценки
   * Ошибки алгоритма поиска
   * Ошибки в дебютной книге
   * Ошибки в таблице эндшпилей.

3. Специалист по компьютерной безопасности тоже оценивает каждое изменение в списке. Он ищет исправления общих программных ошибок.

4. Если не найдено ни одной ошибки, которую можно эксплуатировать, все эксперты выполняют ручной несистематический поиск:

   * Разработчик шахматных движков выполняет ревью программного кода. Он ищет ошибки того же типа, которые искал в списке исправлений.

   * Специалист по компьютерной безопасности выполняет аудит программного кода. Он ищет общие программные ошибки.

   * Шахматисты прогоняют движок через набор позиций, которые считаются сложными для компьютерных программ.

5. Эксперты обсуждают свои результаты. Разработчик шахматных движков и специалист по компьютерной безопасности объясняют шахматистам найденные ошибки и их предполагаемое влияние на игру движка.

6. Команда экспертов проверяет найденные слабости движка в тестовых партиях.

После такой подготовки самый сильный из шахматистов команды играет матч с движком. У него есть список потенциальных слабостей программы. План на матч строится вокруг создания условий, в которых воспроизводятся ошибки движка. Например, это может быть выбор подходящих дебютов, создание нужных комбинаций и связок фигур в миттельшпиле или выход в определённые эндшпили.

Как работает подобная стратегия команды экспертов на практике? Представим следующую гипотетическую ситуацию. Команда Deep Blue проводит третий матч с Гарри Каспаровым. Перед матчем разработчики подробно консультируют шахматиста. Они рассказывают обо всех обнаруженных, но ещё неисправленных ошибках компьютера. Очевидно, что такая информация намного повысит шансы Гарри Каспарова на победу.

Рассмотрим комбинации стратегий разработчиков движка и команды экспертов:

1. Разработчики движка — РНП, команда экспертов — РСП.

2. Разработчики движка — РСП, команда экспертов — РСП.

3. Разработчики движка — АСП, команда экспертов — РСП.

Первый случай (РНП-РСП) вероятнее всего закончится победой команды экспертов. Разработчики большинства шахматных движков применяют сегодня продвинутые техники тестирования и отладки. Стратегию РНП могут применять только любители или начинающие программисты, которые создают шахматный движок в качестве учебного или хобби-проекта. У такого движка нет шансов против профессиональных шахматистов.

Вторая комбинация стратегий — РСП-РСП. Разработчики движка и команда экспертов используют одинаковый подход к поиску ошибок. Но эксперты тратят больше усилий на обнаружение каждой ошибки. Дело в том, что разработчики лучше знают свой движок и имеют специальные инструменты для его отладки. Они могут быстро связать какую-то слабость в игре программы с конкретным местом в её исходном коде. Команде экспертов сделать это намного сложнее.

Чтобы эксперты одержали победу в случае комбинации стратегий РСП-РСП, есть несколько условий:

1. Команде экспертов удалось обнаружить ошибки шахматного движка, которые создают слабые ходы.

2. Найденные ошибки стабильно воспроизводятся и команда экспертов научилась создавать подходящие для этого условия.

3. Если разработчики движка исправляют эксплуатируемые ошибки в ходе матча, у команды экспертов всегда должна оставаться как минимум ещё одна неизвестная разработчикам ошибка.

Последний пункт требует пояснения. Рассмотрим пример. Допустим, что матч состоит из шести партий. Команда экспертов нашла три ошибки в движке, которые приводят к его слабой игре. 

Исход матча отчасти зависит от успешного воспроизведения ошибок командой экспертов и от скорости их исправления разработчиками. Если в какой-то партии шахматисту команды экспертов удалось воспроизвести ошибку, это ещё не гарантирует его победу. Игрок просто получает преимущество, которое движок может вернуть через несколько ходов. С другой стороны, сразу после воспроизведения ошибки разработчики про неё узнают. Они могут исправить проблему до следующей партии. При этом команда экспертов не узнает об этом исправлении. Это означает, что повторная эксплуатация одной и той же ошибки может не сработать.

Учитывая эти варианты, план экспертов на матч может быть таким:

* Эксплуатировать по одной новой ошибке в каждой из трёх партий за белых. Таким образом, играть в этих партиях на победу.

* В каждой партии за чёрных эксплуатировать только ошибки, которые уже знакомы разработчикам по прошлым играм. Если проблему в движке уже исправили, то играть партию на ничью.

Следуя этому плану, у команды экспертов есть неплохие шансы выиграть матч.

Третья комбинация стратегий — АСП-РСП. В этом случае стратегия разработчиков движка сильнее. Высока вероятность, что их система автоматического тестирования уже нашла все ошибки, которые можно было бы воспроизвести и эксплуатировать в условиях матча. Информация об ошибках даёт разработчикам преимущество. Они либо устраняют проблемы заранее перед матчем, либо имеют план по их оперативному исправлению. В этом случае победа команды экспертов маловероятна.

#### 3.8.2.5 Третий сценарий АСП

В третьем сценарии команда экспертов работает в следующих условиях:

1. Команда экспертов состоит из шахматистов, разработчика шахматных движков, специалиста по компьютерной безопасности, специалиста по тестированию, специалиста по статистике и обработке данных.

2. В распоряжении команды есть точная версия шахматного движка, с которой предстоит играть. Также доступна история его изменений и исходный код.

3. У команды есть инструменты для поиска ошибок в шахматном движке.

Инструменты для поиска ошибок повторяют функции системы тестирования, которую используют разработчики движка. Благодаря им, команда экспертов применяет стратегию автоматического систематического поиска ошибок (АСП).

Снова обратимся к примеру, в котором команда экспертов играет против движка Stockfish версии 14. На этапе подготовки команда ищет слабости в игре программы, чтобы эксплуатировать их в ходе матча. Для этого она применяет специальные инструменты.

Есть несколько способов, как можно автоматизировать поиск ошибок в движке:

1. Провести турнир между Stockfish 14 и более сильным шахматным движком. Такой турнир даст набор партий, в которых Stockfish 14 проиграл. Шахматисты из команды экспертов должны проанализировать ходы в этих партиях. Они могут указать на слабые стороны Stockfish 14.

2. Разработчик шахматных движков из команды экспертов составляет список изменений в коде Stockfish, сделанных после выпуска версии 14. Имея на руках исходный код, он может собирать модифицированные версии движка: включая и исключая изменения. Тогда система тестирования поможет оценить влияние каждого изменения на силу игры. Инструмент даст как статистику побед, так и конкретные партии и позиции, в которых Stockfish 14 без исправления ошибки сыграл слабо.

3. Инструмент может проанализировать все официальные партии Stockfish версии 14. Он ищет позиции, в которых Stockfish 14 делает слабый ход по мнению более сильного движка. Шахматисты команды экспертов должны проанализировать эти позиции. Они могут указать на слабые стороны Stockfish 14.

Это только несколько идей, как можно использовать специальные инструменты для поиска ошибок. Возможны и другие варианты.

Специальные инструменты не находят ошибки движка автоматически. Скорее они увеличивают охват поиска. Эксперты получают возможность проверить намного больше аспектов игры программы по сравнению со стратегией РСП. Инструменты только указывают перспективное направление, следуя которому можно найти слабость в игре движка. Всю работу по анализу конкретных игр и позиций по-прежнему выполняет эксперт шахматист.

Рассмотрим комбинации стратегий разработчиков движка и команды экспертов:

1. Разработчики движка — РНП, команда экспертов — АСП.

2. Разработчики движка — РСП, команда экспертов — АСП.

3. Разработчики движка — АСП, команда экспертов — АСП.

В первой комбинации (РНП-АСП) победа команды экспертов очень вероятна. Если разработчики движка используют стратегию РНП сегодня, это говорит о его низком качестве. Конкуренцию профессиональным шахматистам он составить не может.

Вторая комбинация стратегий — РСП-АСП. Стратегия поиска ошибок у команды экспертов сильнее. Потенциально они найдут больше ошибок для эксплуатации, чем дала бы им стратегия РСП. Это означает, что на каждую партию матча у экспертов может быть заготовлено по одной-две ошибки движка. Такая подготовка значительно повышает их шансы как в партиях за белых, так и в партиях за чёрных. Теперь шахматист может играть на победу независимо от цвета своих фигур.

После того как шахматист эксплуатирует какую-то ошибку движка, разработчики могут её исправлять до следующей партии. Но эта работа практически не повлияет на исход матча, если команда экспертов нашла достаточно ошибок. В этом случае движок, скорее всего, проиграет матч.

Третья комбинация стратегий — АСП-АСП. Стороны используют одинаковый подход для поиска ошибок. В этом случае исход матча зависит от вложенных ресурсов. Разработчики движка вкладываются в поиск и исправление ошибок при выпуске его очередной версии. Эксперты тратят ресурсы на подготовку к матчу. Характер этих ресурсов один и тот же:

1. Вычислительные мощности для запуска системы тестирования и специальных инструментов.

2. Время работы системы тестирования и специальных инструментов.

3. Время экспертов для анализа найденных ошибок и слабостей программы.

Сторона, вложившая в поиск ошибок больше ресурсов, вероятнее всего, одержит победу в матче. Рассмотрим пример. Разработчики Stockfish версии 14 используют систему интенсивного тестирования Fishtest. Команде экспертов нужны вычислительные ресурсы, соизмеримые этой системе. В против случае их поиск ошибок с большой вероятностью закончится неудачей.

#### 3.8.2.6 Реалистичность сценариев

Мы рассмотрели три сценария игры команды экспертов против шахматного движка. Все крупные матчи именитых шахматистов против программ в 2000-х годах проходили в условиях, близких к первому сценарию. Возникает вопрос: насколько реалистичны второй и третий сценарии?

После поражения Владимира Крамника в матче с Deep Fritz в 2006 году шахматное сообщество и публика потеряли интерес к подобным противостояниям. Стало сложно найти спонсоров и участников. Шахматисты высшего уровня не хотят тратить своё время на подготовку к малоперспективному матчу.

Второй и третий сценарии требуют серьезных вложений. Команда экспертов должна состоять из шахматистов уровня претендента. В неё также должны входить эксперты разных направлений ИТ высокого уровня. Чем выше уровень экспертов, тем выше их шансы успешно подготовиться к матчу. Если шахматный движок коммерческий, то необходимо сотрудничество со стороны его разработчиков. Они должны предоставить исходный код и историю изменений программы.

Чтобы выполнить условия второго и третьего сценариев, есть много требований. В теории, они все выполнимы. На практике же возникает вопрос: ради чего такие усилия? В лучшем случае команда экспертов выиграет матч против старой версии не самого сильного шахматного движка. В таком достижении нет ничего привлекательного ни для зрителей, ни для команды экспертов высшего класса, ни для спонсоров мероприятия. Поэтому матч на таких условиях вряд ли когда-нибудь состоится.

Можно ли поднять ставки в таком противостоянии? Есть ли у команды экспертов шансы против последней версии Stockfish? Ряд особенностей этого движка помешает команде экспертов найти в нём ошибки. Даже если они будут следовать стратегии АСП. Эти особенности следующие:

1. **Сеть NNUE вместо функции оценки**. Специалист по шахматным движкам может выполнить ревью кода функции оценки и понять его логику. Возможно, он найдёт в нём изъяны. Но анализ параметров обученной сети NNUE ничего не скажет о её слабостях. Изменения параметров невозможно интерпретировать в шахматных понятиях.

2. **Система тестирования Fishtest**. Интенсивное автоматизированное тестирование выявляет основную массу ошибок в движке Stockfish. Если в нём остались скрытые ошибки, они либо незначительные, либо их очень сложно воспроизвести.

3. **Информация об исправлениях в последней версии Stockfish ограничена**. У команды экспертов есть только небольшая история изменений после последнего релиза. Маловероятно найти среди них подходящую для эксплуатации ошибку.

Из истории противостояния человека и шахматных программ можно сделать следующий вывод. Игра против системы, которая достигла сверхчеловеческого уровня в какой-то дисциплине, не имеет ничего общего с игрой против человека. Это противостояние больше напоминает поиск и эксплуатацию уязвимостей в программной системе. Только такой подход даёт хоть какие-то шансы на победу над машиной.

#### 3.8.3 Стратегия игры против машины

Мы рассмотрели разные стратегии поиска ошибок в программах. Их могут применять обе стороны: как разработчики шахматных движков, так и шахматисты, играющие против программ. Попробуем обобщить эти рассуждения и поговорим о стратегии человека против машины в любой игре.

Начнём с предусловий для такого противостояния. Во-первых, человек должен быть экспертом в игре. Например, если это шахматы, он должен быть гроссмейстером. Чем выше уровень игрока, тем разнообразнее ошибки машины, которые он сможет эксплуатировать. Это могут быть не только понятные новичку тривиальные зевки, но и тонкие стратегические просчёты.

Во-вторых, человеку нужен надёжный источник информации о машине. Это может быть история её прошлых игр, исходный код управляющей программы, технические подробности реализации. Если этого нет, человек должен иметь возможность самостоятельно наиграть достаточно партий против машины.

В-третьих, версия машины и её управляющей программы должна быть зафиксирована. Любое изменение в аппаратном или программном обеспечении означает, что игрок теперь соревнуется с совершенно другой машиной.

Общий алгоритм подготовки и игры против машины выглядит следующим образом:

1. Собрать предварительную информацию о машине.

2. Создать повторяемую среду для работы машины.

3. Найти подходящие для эксплуатации ошибки или закономерности в поведении машины.

4. Научиться воспроизводить найденные ошибки и закономерности поведения машины.

5. Эксплуатировать ошибки в матче против машины.

Начнём с первого пункта: сбор информации. Следующие сведения помогут игроку эффективнее подготовится к матчу:

1. В какой проблемной среде работает машина?

2. К какому типу интеллектуального агента относится машина?

3. Какую стратегию поиска ошибок применяли разработчики?

Ответы на эти вопросы могут сразу указать на потенциальные слабости машины. Например, пусть игра представляет собой частично наблюдаемую среду. Машина представляет собой основанного на полезности агента, который работает на каком-то алгоритме состязательного поиска. В этом случае у неё есть принципиальная проблема с обработкой информации. Машина не способна делать долгосрочные выводы из сведений, полученных несколько шагов назад. Также она не учитывает информацию, которая доступна оппоненту. Этот изъян можно использовать, чтобы получить преимущество.

Второй шаг алгоритма — создать повторяемую среду. Одно из предусловий заключается в том, что версия машины и управляющей программы не меняются. Кроме этого машина должна постоянно играть в одних и тех же условиях.

Допустим, что игра — это [компьютерная стратегия в реальном времени](https://ru.wikipedia.org/wiki/Стратегия_в_реальном_времени) (real-time strategy или RTS). Тогда в каждой партии следующие условия не должны меняться:

* карта
* фракция, за которую играет машина
* фракция игрока
* версия игры (патч)
* аппаратное обеспечение машины.

Такое постоянство среды фиксирует поведение машины. Если в нём удастся обнаружить ошибку или закономерность, они будут воспроизводимы. То есть каждый раз попав в определённые условия, машина всегда будет принимать одни и то же решения.

Третий шаг — найти подходящие для эксплуатации ошибки или закономерности. Выполнять этот шаг можно только тогда, когда среда работы машины зафиксирована. В противном случае любое изменение среды или самой машины потенциально делает обнаруженную ошибку невоспроизводимой.

Перед началом поиска ошибок полезно классифицировать их по каким-то признаком. Это могут быть компоненты машины, которые работают с ошибкой. Также признаками могут быть разные аспекты игры, в которых машина ошибается. Классификация ошибок помогает упорядочить процесс поиска.

Независимо от характера игры есть ряд типичных ошибок:

1. **Машина не справляется со сложностью правил игры**. Например, в игре может быть так много объектов, их параметров и способов взаимодействия, что машина не способна учесть все возможные комбинации. В этом случае достаточно найти такие состояния среды, которые машина не понимает. Её действия в этих состояниях будут неадекватными.

2. **Машина не справляется с вычислительной сложностью игры**. Пример такой проблемы — эффект горизонта в ранних шахматных программах. Они просчитывали до четырёх ходов вперёд. Это означает, что программа не видит планы и комбинации оппонента на пять ходов вперёд и более.

3. **Логические ошибки при выборе действия**. Если машина или её часть реализована как рефлексный агент, типична ошибка интерпретации текущего состояния среды. Например, два состояния похожи по некоторым признакам и машина не может их различить. Тогда она может  выбрать действие, которое корректно для одного состояния, но неверно для другого.

4. **Ошибки обучения модели**. Если машина представляет собой обучающегося агента, надо проверить типичные ошибки алгоритма обучения: низкая производительность модели, переобучение, недообучение, плохая обобщающая способность и т.д.

5. **Ошибки долгосрочного планирования**. Такие проблемы встречаются у всех типов интеллектуальных агентов. В сложных играх решения участников могут иметь долгосрочные последствия. Чтобы их учесть, нужны серьёзные вычислительные ресурсы. Если машина не может связать причины и следствия игровых событий, её действия будут неадекватными.

При поиске слабостей машины важно учитывать стратегию поиска ошибок, которой следовали её разработчики. Стратегия поиска ошибок со стороны игрока должна быть не слабее. В противном случае маловероятно, что он найдёт ещё неисправленные проблемы, подходящие для эксплуатации.

Слабости в игре машины могут создавать не только ошибки в её управляющей программе или оборудовании. В некоторых играх предсказуемость оппонента даёт значительное преимущество. В этом случае стоит искать также закономерности и шаблоны в поведении машины. Если она каждый раз реагирует одинаково на определённую игровую ситуацию, это можно эксплуатировать в своих целях.

Четвёртый шаг алгоритма — научиться воспроизводить найденные слабости машины и закономерности её поведения. Некоторые ошибки и действия могут быть спорадическими. Их можно учитывать в партиях итогового матча, но вокруг них нельзя строить стратегию игры против машины.

I> **Спорадические ошибки** программы воспроизводятся случайно с некоторой долей вероятности. Например, в один запуск из десяти.

Повторяемая среда работы машины так же важна при воспроизведении найденных слабостей, как и при их поиске.

Пятый шаг — эксплуатация найденных слабостей в игре машины. На этой стадии самое важное — вмешательство разработчиков в работу машины. Если они вносят исправления, у игрока должен быть достаточный набор ошибок для эксплуатации. Его должно хватить на все партии итогового матча.

В процессе итогового матча игрок может обнаружить новые слабости машины. Но полагаться на это не стоит, тем более если разработчики сразу получат информацию о проблеме и смогут её исправить. Именно подготовка к матчу во многом определит его исход. 

Если машина играет на сверхчеловеческом уровне, успешная подготовка не гарантирует игроку победы. Любая его случайная ошибка может привести к поражению. Подготовка только повышает шансы на успех.

{pagebreak}
