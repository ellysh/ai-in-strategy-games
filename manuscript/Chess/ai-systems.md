## 3.4 Шахматные программы

Рассмотрим лучшие шахматные программы, которые побеждали на турнирах среди программ. В результате развития они смогли победить чемпиона мира по шахматам. Сегодня шахматные программы не оставляют шансов профессиональным игрокам.

#### 3.4.1 История

##### 3.4.1.1 Шахматная программа Бернштейна

Первую полноценную шахматную программу разработал сотрудник IBM Алекс Бернштейн со своими коллегами в 1957 году. Она получила название [The Bernstein Chess Program](https://www.chessprogramming.org/The_Bernstein_Chess_Program) (шахматная программа Бернштейна).

Предыдущие системы такие как General Problem Solver могли решать некоторые шахматные задачи. Например, из заданной позиции они находили мат за два хода. Но такие программы не могли сыграть партию от начала до конца. В отличие от них программа Бернштейна могла сыграть партию целиком.

У Бернштейна было преимущество в том, что он использовал новейший компьютер от [IBM 704](https://ru.wikipedia.org/wiki/IBM_704). Это первый компьютер массового производства. По меркам 1950-х годов он был одним из самых производительных. Кроме этого Бернштейна консультировал американский гроссмейстер Артур Бисгайер.

Шахматная программа Бернштейна использовала таблицы дебютов. Она распознавала известные в те годы начала партий и выбирала лучшие ходы по сохранённым в памяти таблицам.

Для игры в миттельшпиле шахматная программа Бернштейна использовала стратегию типа Б в терминологии Клода Шеннона.

В 1949 году Клод Шеннон опубликовал статью "Программирование компьютера для игры в шахматы" ("Programming a Computer for Playing Chess"). В ней он описал две стратегии для шахматных программ:

* [Стратегия типа A](https://www.chessprogramming.org/Type_A_Strategy)
* [Стратегия типа Б](https://www.chessprogramming.org/Type_B_Strategy)

Стратегия типа А заключается в просчёте наперёд всех возможных ходов и поиске среди них наилучшего. Шеннон полагал, что использующая эту стратегию шахматная программа будет слабым игроком. Причину этого он видел в большом коэффициенте ветвления дерева поиска и комбинаторном взрыве количества возможных позиций.

Стратегия типа Б прелагает просчитывать только небольшое подмножество наиболее перспективных ходов.

Шахматная программа Бернштейна использовала минимаксный алгоритм для просчёта восьми ходов вперёд. Чтобы начать расчёт вглубь, она выбирала семь наиболее перспективных ходов. Для этого выбора учитывались следующие качества позиции:

1. Выигрыш материала.
2. Подвижность фигур.
3. Контроль доски.
4. Безопасность короля.

В среднем программа тратила 8 минут на поиск хода. Она играла на уровне любителя.

##### 3.4.1.2 Шахматный компьютер Belle

В августе 1969 года Кен Томпсон и Деннис Ритчи разработали первый прототип операционной системы Unix для миникомпьютера PDP-7. Томпсон был любителем шахмат и решил написать пробную шахматную программу [Belle](https://www.chessprogramming.org/Belle, работающую на новой ОС.

Проект Belle начинался как программный. Позднее к Томпсону присоединился Джо Кондон. Он предложил разработать специальный компьютер, оптимизированный для расчёта шахматных ходов.

{caption: "Иллюстрация 3-2. Шахматный компьютер Belle"}
![Компьютер Belle](images/Chess/belle.jpg)

 Компьютер Belle состоял из трёх аппаратных модулей:

1. Генератор ходов ([move generator](https://www.chessprogramming.org/Move_Generation))

2. Модуль оценки позиции ([position evaluator](https://www.chessprogramming.org/Evaluation))

3. Таблица транспозиций ([transposition table](https://www.chessprogramming.org/Transposition_Table))

Генератор ходов использует эвристику под названием **самая ценная жертва, наименее ценный агрессор** (Most Valuable Victim - Least Valuable Aggressor или [MVV-LVA](https://www.chessprogramming.org/MVV-LVA). Идея этой эвристики — среди атакованных фигур противника найти самую ценную. Она называется жертвой. Ценность фигур убывает в таком порядке: ферзь, ладья, слон, конь, пешка. Следующий шаг — найти наименее ценную фигуру из тех, которые атакуют жертву. Такая фигура называется агрессором.

Несмотря на простоту эвристика MVV-LVA находит список перспективных ходы во многих позициях. Получив такой список, шахматный компьютер просчитывает возможные позиции вперёд на глубину нескольких ходов. Такой подход позволяет значительно сократить число расчётов.

Модуль оценки позиции даёт численную оценку каждой позиции, который рассматривает шахматный компьютер. Это может быть позиция, полученная в результате перспективного хода или наиболее вероятного ответа оппонента. Модуль оценки учитывает несколько факторов:

1. Позицию и безопасность короля в зависимости от стадии партии.

2. [Таблицу фигур и полей](https://www.chessprogramming.org/Piece-Square_Tables).

3. Пешечную структуру.

4. Мобильность фигур.

5. Открытые диагонали и линии.

Таблица фигур и полей составляется для каждой черной и белой фигуры. Таблица представляет собой численные оценки клеток, которые фигура может занять на доске. Чем выше оценка, тем выгоднее позиция. При этом расположение других фигур таблица не учитывает. Благодаря таблице, шахматная программа может быстро оценить насколько выгодно занимать фигурой ту или иную клетку на доске.

Третий аппаратный модуль Belle — таблица транспозиций. В ней сохраняются позиции, которые программа находит в результате всех выполненных итераций поиска. В одну и ту же позицию ведут разные последовательности ходов. Эти последовательности называются **транспозициями**. Благодаря таблице, компьютеру не приходится снова и снова оценивать одни и те же позиции. Это значительно ускоряет поиск по дереву игры.

Компьютер Belle использовал стратегию типа А в терминологии Клода Шеннона. Он перебирал все свои возможные ходы в текущей позиции. На каждый из них Belle рассматривал все возможные ответные ходы оппонента. Благодаря эвристикам, Belle удавалось значительно сокращать дерево поиска.

Первая версия Belle просчитывала партию на четыре хода вперёд. К 1978 году это число увеличилось до восьми ходов. В этому году компьютер впервые учавствовал и занял первое место на [Северо-Американском чемпионате по шахматам среди компьютерных программ](https://ru.wikipedia.org/wiki/Северо-Американский_чемпионат_по_шахматам_среди_компьютерных_программ). После Belle ещё четыре раза выигрывал этот чемпионат.

В 1980 Belle выиграл [Международный чемпионат по шахматам среди компьютерных программ](https://ru.wikipedia.org/wiki/Чемпионат_мира_по_шахматам_среди_компьютерных_программ). А в 1982 компьютер достиг рейтинга в 2250 пунктов Эло, что соответствует уровню мастера.

#### 3.4.1 Шахматные турниры

Первый шахматный турнир для программ был организован 