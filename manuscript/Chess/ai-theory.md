## Теория ИИ и шахматы

Мы рассмотрели шахматы с точки зрения теории игр. Теперь оценим эту игру с точки зрения теории интеллектуальных агентов. Она поможет нам сформулировать формальные требования к системе ИИ для игры в шахматы.

### Проблемная среда

Определим, к какому классу проблемных сред относится игра в шахматы. Для этого обратимся к таблице 2-5. В ней перечисленны признаки классификации сред.

Агент может получить состояние шахматной доски в любой момент времени. Скрытых состояний у игры нет. Из этого следует, что шахматы — это полностью наблюдаемая среда.

В шахматах нет случайных событий. Каждое состояние среды зависит только от её предыдущего состояния и действий агентов. Поэтому среда будет детерминированной.

Агент, играющий в шахматы, воспринимает среду последовательно. Каждое его действие имеет долгосрочные последствия для позиции фигур на доске.

В шахматах участники делают ходы друг за другом. Позиция на доске меняется только после очередного хода. Такие изменения характерны для статических сред. Однако, по правилам классических шахмат каждому участнику отводится определённое время на все ходы. Когда время заканчивается, игроку засчитывается поражение. Получается, что с течением времени меняются показатели производительности агента. В этом случае среда считается полудинамической.

Агент может однозначно различить все состояния шахматной доски. Количество этих состояний огромно, но конечно. Точно так же различимы и конечны игровое время и ходы игроков. Следовательно, шахматы — это сложная дискретная среда.

В шахматы играет одновременно два участника. Их показатели производительности обратно пропорциональны. Поэтому шахматы относятся к мультиагентным конкурентным средам.

Правила шахмат относительно просты для того, чтобы представить их в удобной для агента форме. Не зная эти правила, агент не сможет играть. Ведь нарушать правила строго запрещено. Поэтому шахматы можно считать средой, известной агенту.

Подведём итог. С точки зрения теории интеллектуальных агентов шахматы относятся к следующему типу среды:

* Полностью наблюдаемая
* Детерминированная
* Последовательная
* Полудинамическая
* Дискретная
* Мультиагентная и конкурентная
* Известна агенту
* Сложная

### Интеллектуальный агент

Мы определили, к какому классу среды относятся шахматы. Теперь выясним, какой тип интеллектуальных агентов имеет достаточно возможностей для ведения игры.

Рассмотрим все типы агентов начиная с самого простого. Так мы найдём минимально достаточные требования к агенту.

#### Рефлексные агенты

Сможет ли играть в шахматы простой рефлексный агент? Агент этого типа игнорирует последовательность актов восприятия. Он ориентируется только на текущее состояние среды. При этом её возможные будущие состояния не учитываются.

В общем случае рефлексный агент может работать в простой среде, с такими же признаками как у шахмат.

Например, рефлексный агент может успешно играть в крестики-нолики с полем 3 на 3 клетки. Крестики-нолики считаются [решённой игрой](https://en.wikipedia.org/wiki/Solved_game). Это значит, что для каждого игрока найдена стратегия, которая приводит к наилучшему результату. Если оба игрока придерживаются лучшей стратегии, партия заканчивается ничьей.

Чтобы рефлексный агент смог играть в крестики-нолики, его таблица правил должна содержать следующее:

* Все состояния поля игры, допустимые правилами.

* Ходы агента, которые реализуют лучшую стратегию, для каждого состояния поля.

Имея такую таблицу правил, простой рефлексный агент сможет отыгрывать лучшую стратегию в ответ на любые действия оппонента.

Какой размер таблицы правил нужен рефлексному агенту для игры в крестики-нолики? Всего существует 3^9^ или 19683 способов заполнить поле 3 на 3. Каждая клетка может быть пустой, либо в ней может стоять крестик или нолик. Из всех 19683 комбинаций только 5478 удовлетворяют правилам игры. Таким образом таблица правил рефлексного агента содержит 5478 строк.

Каждая строка содержит состояние игрового поля (9 клеток) и соответствующее ему действие агента. Действие агента можно закодировать в 9 битах. Это ход в одну из девяти клеток поля. Состояние доски можно сохранить в `9 * 3 = 27` битах. Это девять клеток поля, у каждой из которых может быть три состояния: пустая, крестик или нолик. Итого мы получаем размер таблицы `5478 * (27 + 9) = 197208` бит или 24651 байт.

Мы выяснили, что для простой игры в крестики-нолики рефлексному агенту нужна таблица правил размером около 25 Мбайт. Теперь попробуем представить, какого размера таблица правил нужна для шахмат.

Как выяснил Клод Шеннон, существует около 10^44^ возможных позиций на шахматной доске. Это число несоизмеримо больше 5478 — числа возможных состояний поля в крестиках ноликах. Соотношение чисел 10^44^ и 5478 показывает насколько больше таблица правил для шахмат, чем для крестиков-ноликов. Современные компьютерные технологии просто не позволяют сохранить такой объем информации.

Есть ещё одна проблема при создании рефлексного агента для игры в шахматы. Шахматы до сих пор не решены. Это значит, что лучшие стратегии для белых и чёрных неизвестны. Поэтому даже если бы удалось составить таблицу правил для игры, стратегия рефлексного агента была бы далеко не лучшей.

Добавим рефлексному агенту внутреннее состояние и модель среды. Это не поможет ему успешно играть в шахматы. Причина в том, что он по-прежнему выбирает свой очередной ход из таблицы правил. Как мы выяснили, составить и сохранить таблицу правил для игры в шахматы невозможно на сегодняшний день. Поэтому никакой рефлексный агент не подойдёт для нашей задачи.

#### Агенты, использующие поиск

Теперь рассмотрим интеллектуальных агентов, которые в своей работе используют алгоритмы поиска. Смогут ли они играть в шахматы?

Первый тип агентов использует знание о цели. Цель шахматной партии заключается в том, чтобы поставить оппоненту мат. Агент, основанный на цели, строит дерево состояний модели и возможных действий. Далее он ищет узел с целевым состояние среды. В нашем случае целевое состояние — это позиция фигур на доске, при которой агент поставил оппоненту мат.

Агент, основанный на цели, начинает свой поиск из корневого узла дерева. Этот узел соответствует начальному расположению фигур на шахматной доске как на иллюстрации 3-1.

Шахматы относятся к сложным средам с точки зрения вычислений. Поэтому дерево поиска не поместится в память компьютера. Из-за этого агент не сможет проанализировать всё дерево целиком. Разделить дерево на части у него не получится. Следовательно, основанный на цели агент не сможет играть в шахматы.

Можно ли решить проблему, если заменить информацию о цели на функцию полезности? Используя функцию, агент сможет анализировать дерево поиска по частям.

Теперь агенту не нужно проходить по всему дереву поиска, начиная с начальной позиции и заканчивая матом оппоненту. Вместо этого агент может проверить первые 5-10 ходов. Каждая проверенная последовательностей ходов приведёт к какому-то состоянию среды. Функция полезности даст оценку каждому из этих состояний. Далее агенту остаётся только выбрать состояние с наибольшей оценкой. Последовательность ходов, которая приведёт к этому состоянию и будет наилучшей.

Единственная сложность в реализации агента — выбор подходящей функции полезности. Шахматная стратегия и тактика предлагают наборы универсальных правил. Агент должен учитывать эти правила в своей оценке позиций.

Возможны ситуации, когда несколько правил конфликтуют друг с другом. В этом случае агент должен выбирать более приоритетные для него правила.

В общем случае качество игры агента зависит от двух факторов:

* Количество ходов, которые агент просчитывает наперёд.

* Качество функции полезности для оценки позиций.

Постепенно улучшая каждый из этих двух факторов, от агента можно добиться высокого уровня игры в шахматы.

#### Обучающийся агент

Обучающийся агент способен справиться со сложными средами с точки зрения вычислений. При этом...

// TODO: Закончить этот раздел