# Приложение

## Искусственный интеллект

### 1. Классический поиск

// TODO

### 2. Состязательный поиск

// TODO


### 3. Машинное обучение

#### 3.1. Классификация набора ирисы Фишера

// TODO

#### 3.2. Линейная регрессия цены на поддержанные автомобили

// TODO

#### 3.3. Кластеризация пользователей онлайн магазина методом k-средних

Скрипт `k-mean-clustering.py` из листинга 5-3 демонстрирует следующие действия:

1. Сгенерировать случайный набор точек в двумерном пространстве.

2. Кластеризация точек методом k-средних.

3. Вывод результата кластеризации в виде графике.

{caption: "Листинг 5-3. Скрипт кластеризации методом k-средних", line-numbers: true, format: Python}
![`k-mean-clustering.py`](code/ArtificialIntelligence/k-mean-clustering.py)

Для работы скрипт импортирует следующие модули:

* `datasets` из библиотеки `sklearn` — содержит методы для генерации наборов данных. Кроме того в него входят методы загрузки эталонных наборов данных для тестирования новых алгоритмов обучения.

* `cluster` из библиотеки `sklearn` — в нём реализованы популярные алгоритмы обучения без учителя для задачи кластеризации.

* `pyplot` из библиотеки `matplotlib` — это интерфейс для построения графиков.

Скрипт начинается с вызова функции [`make_blobs`](https://scikit-learn.org/stable/datasets/sample_generators.html#sample-generators) из модуля `datasets`. Эта функция генерирует кластеры точек на двумерном пространстве признаков. Координаты центров кластеров выбираются случайно. Точки каждого кластера находятся на случайном расстоянии от его центра. Эти расстояния соответствуют [нормальному распределению вероятностей](https://ru.wikipedia.org/wiki/Нормальное_распределение).

Результат генерации кластеров точек сохраняется в переменной `X`. Эта переменная представляет собой массив. Каждый его элемент соответствует одной точке. Точка представляет собой пару чисел: координаты по оси X и Y.

Далее скрипт создаёт объект класса [`KMeans`](https://scikit-learn.org/stable/modules/clustering.html#k-means) из модуля `cluster`. Этот объект сохраняется в переменной `kmeans`. В классе `KMeans` реализован алгоритм обучения методом k-средних.

В нашем случае конструктор класса `KMeans` принимает только два входных параметра:

* `n_clusters` — число кластеров, которые должна найти обучаемая модель.

* `random_state` — параметр генератора случайных чисел. Если присвоить ему целое число, то алгоритм обучения будет выдавать одинаковый результат для одного и того же набора данных при перезапуске скрипта.

После создания объекта класса `KMeans` скрипт вызывает его метод `fit` с параметром `X`. Этот метод выполняет алгоритм обучения на наборе данных, который хранится в переменной `X`.

Далее скрипт строит график с результатами обучения. Для этого из модуля `pyplot` вызываются следующие функции:

1. `figure` — конструктор глобального объекта класса `Figure`. Он хранит все видимые графические элементы.

2. `xlabel` — указывает надпись для оси X.

3. `ylabel` — указывает надпись для оси Y.

4. `scatter` — рисует набор точек на плоскости.  Функция принимает следующие параметры:
   * Первый параметр — это массив с координатами точек по оси X.
   * Второй параметр — массив с координатами точек по оси Y.
   * `c` — массив со списком цветов для каждой точки.
   * `s` — размер точек.
   * `alpha` — уровень прозрачности от 0 (прозрачный) до 1 (непрозрачный).

5. `show` — вывести на экран всё содержимое всех объектов класса `Figure`.

Первый вызов функции `scatter` рисует все точки из сгенерированного набора. Функция принимает следующие параметры:

* `X[:,0]` — первые числа всех элементов массива `X`. Эти числа соответствуют координатам точек по оси X.

* `X[:,1]` — вторые числа всех элементов массива `X`. Эти числа соответствуют координатам точек по оси Y.

* `c=kmeans.labels_.astype(float)` — массив, каждый элемент которого соответствует точке из обучающего набора данных. Значение элемента — номер кластера к которому алгоритм обучения отнёс соответствующую точку.

Второй вызов функции `scatter` рисует центры кластеризации, которые нашёл алгоритм k-средних. Функция принимает следующие параметры:

* `centers[:, 0]` — координаты X центров всех кластеров, которые нашёл алгоритм обучения.

* `centers[:, 1]` — координаты Y центров всех кластеров, которые нашёл алгоритм обучения.

* `c='black'` — чёрный цвет, которым надо раскрасить центры кластеров.

* `s=200` — размер каждого центра кластера.

* `alpha=0.5` — полупрозрачность.

Иллюстрация 2-16 демонстрирует результат работы скрипта `k-mean-clustering.py`.